# Poisson_com_caudas.R
# altere o que deseja
lambda <- 2.75
max_plotar <- 15 # valor maximo para plotar (Poisson vai a + infinito)
cauda <- 3 # a partir de onde hachurar e calcular p da area
cor = "#1965B0" # RGB
# grafico e calculo
hachura <- 500/max_plotar
if (hachura < 10) {hachura <- 10}
if (hachura > 35) {hachura <- 35}
cor_transparencia <- paste(cor,"88",sep="")
eventos <- 0:max_plotar
probs <- dpois(eventos,lambda)
# data frame com a distribuicao de Poisson
poisson <- data.frame(eventos,probs)
names(poisson) <- c("Eventos", "Probabilidade")
plot (poisson$Eventos, poisson$Probabilidade, 
      main="Distribuição de Poisson", 
      xlab="Número de ocorrências", 
      ylab="Probabilidade",
      lwd=3, col=cor, type = "h")
points(poisson$Eventos, poisson$Probabilidade, 
       col=cor, bg=cor, pch=21)
# cauda direita
lines (poisson$Eventos[poisson$Eventos>cauda], 
       poisson$Probabilidade[poisson$Eventos>cauda], 
       col=paste(cor,"88",sep=""), 
       lwd=hachura, type="h")
print(poisson)
prob_dir <- sum(poisson$Probabilidade[poisson$Eventos<=cauda])
cat("\nP[eventos <= ",cauda,"] =",prob_dir)
cat("\nP[eventos >  ",cauda,"] =",1-prob_dir)
cat("\n")
